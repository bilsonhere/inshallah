<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>From Heart, To Heart</title>
    <style>
        /* Base Styles */
        :root {
            --parchment: #f5e9d9;
            --parchment-dark: #e8d9c5;
            --ink-color: #3a3226;
            --gold-accent: #c9a66b;
            --ruby-red: #9c2c2c;
            --emerald-green: #2c7c5c;
            --royal-blue: #3a5a78;
            --romantic-pink: #ffd6e0;
            --soft-beige: #f5e6d8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'IM Fell English', serif;
            background-color: var(--parchment);
            color: var(--ink-color);
            line-height: 1.6;
            overflow-x: hidden;
            background-image: url('https://www.transparenttextures.com/patterns/old-paper.png');
            background-attachment: fixed;
        }

        /* Font Import */
        @import url('https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&family=IM+Fell+English+SC&family=MedievalSharp&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&display=swap');

        /* Layout */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 3rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeIn 1s ease forwards 0.3s;
            position: relative;
            background: linear-gradient(to right, var(--romantic-pink), var(--soft-beige), var(--parchment));
            padding: 2rem;
            border-radius: 8px;
            border: 1px solid var(--parchment-dark);
        }

        header::before, header::after {
            content: "";
            position: absolute;
            height: 2px;
            width: 100%;
            background: linear-gradient(90deg, transparent, var(--gold-accent), transparent);
            left: 0;
        }

        header::before {
            top: 0;
        }

        header::after {
            bottom: 0;
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 3rem;
            color: var(--ruby-red);
            margin-bottom: 1rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .intro-text {
            font-family: 'IM Fell English', serif;
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto 2rem;
            font-style: italic;
        }

        /* Wax Seal Effect */
        .wax-seal {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, var(--romantic-pink), var(--ruby-red) 70%);
            border-radius: 50%;
            margin: 1rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-family: 'MedievalSharp', cursive;
            font-size: 1.5rem;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16);
            border: 2px solid var(--parchment-dark);
            opacity: 0;
            animation: sealAppear 1s ease forwards 1.5s;
        }

        @keyframes sealAppear {
            from { transform: scale(0) rotate(-90deg); opacity: 0; }
            to { transform: scale(1) rotate(0); opacity: 1; }
        }

        /* Sections */
        .section {
            background-color: var(--parchment);
            border-radius: 8px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.7s ease;
            position: relative;
            border: 1px solid var(--parchment-dark);
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            background-image: url('https://www.transparenttextures.com/patterns/rice-paper.png');
        }

        .section::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 10px;
            background: linear-gradient(90deg, var(--royal-blue), var(--emerald-green), var(--ruby-red), var(--gold-accent));
            opacity: 0.3;
            border-radius: 8px 8px 0 0;
        }

        .section.visible {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* Welcome Section */
        #welcome-section {
            text-align: center;
            background: linear-gradient(to bottom, var(--romantic-pink), var(--parchment));
        }

        .personal-greeting {
            font-family: 'Dancing Script', cursive;
            font-size: 2.5rem;
            color: var(--ruby-red);
            margin-bottom: 1.5rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 2rem;
            position: relative;
        }

        label {
            display: block;
            font-family: 'IM Fell English SC', serif;
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
            color: var(--ink-color);
            letter-spacing: 0.5px;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 1.2rem;
            border: 1px solid var(--parchment-dark);
            border-radius: 8px;
            font-family: 'IM Fell English', serif;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background-color: rgba(255, 255, 255, 0.7);
            color: var(--ink-color);
            line-height: 1.6;
        }

        textarea {
            min-height: 180px;
            resize: vertical;
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid var(--romantic-pink);
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: var(--gold-accent);
            box-shadow: 0 0 0 3px rgba(201, 166, 107, 0.2);
        }

        /* Ready Check Section */
        .ready-check {
            text-align: center;
            background: linear-gradient(to bottom, var(--soft-beige), var(--parchment));
        }

        .ready-options {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 3rem 0;
        }

        .ready-btn {
            padding: 1rem 2.5rem;
            border: none;
            border-radius: 8px;
            font-family: 'IM Fell English SC', serif;
            font-weight: normal;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 1.1rem;
            min-width: 160px;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .ready-btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(255,255,255,0.1), rgba(255,255,255,0));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .ready-btn:hover::after {
            opacity: 1;
        }

        .ready-btn.yes {
            background-color: var(--emerald-green);
        }

        .ready-btn.no {
            background-color: var(--ruby-red);
        }

        .ready-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        /* Buttons */
        .btn {
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 8px;
            font-family: 'IM Fell English SC', serif;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            display: inline-block;
            text-align: center;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(rgba(255,255,255,0.1), rgba(255,255,255,0));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .btn:hover::after {
            opacity: 1;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }

        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .btn-submit {
            margin-top: 1.5rem;
            background-color: var(--royal-blue);
        }

        .btn-back {
            background-color: var(--ink-color);
            margin-right: 1rem;
        }

        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        /* Question Text */
        .question-text {
            font-family: 'IM Fell English SC', serif;
            font-size: 1.4rem;
            margin-bottom: 1.5rem;
            color: var(--ink-color);
            position: relative;
            padding-left: 1.5rem;
            letter-spacing: 0.5px;
        }

        .question-text::before {
            content: "‚úß";
            position: absolute;
            left: 0;
            color: var(--ruby-red);
            font-size: 1.8rem;
        }

        /* Final Message */
        .final-message {
            text-align: center;
            font-style: italic;
            font-size: 1.1rem;
            line-height: 1.8;
            padding: 1rem;
            background-color: rgba(255, 214, 224, 0.3);
            border-radius: 8px;
        }

        .confirmation-dialog {
            background-color: var(--parchment);
            padding: 2rem;
            border-radius: 8px;
            margin-top: 2rem;
            border: 1px solid var(--parchment-dark);
            display: none;
            background: linear-gradient(to bottom, var(--parchment), var(--soft-beige));
        }

        .confirmation-dialog.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 3rem;
            padding: 1.5rem;
            font-family: 'IM Fell English', serif;
            font-size: 0.8rem;
            color: var(--ink-color);
            opacity: 0.7;
            position: relative;
            background: linear-gradient(to right, var(--romantic-pink), var(--soft-beige), var(--parchment));
            border-radius: 8px;
        }

        footer::before {
            content: "";
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--gold-accent), transparent);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container { padding: 1.5rem; }
            h1 { font-size: 2.2rem; }
            .intro-text { font-size: 1rem; }
            .section { padding: 1.8rem; }
            .personal-greeting { font-size: 2rem; }
            .ready-options { flex-direction: column; gap: 1rem; }
            .ready-btn { width: 100%; }
            .button-group { flex-direction: column; gap: 1rem; }
            .btn-back { margin-right: 0; order: 2; }
            .btn-submit { order: 1; }
        }

        @media (max-width: 480px) {
            .container { padding: 1rem; }
            h1 { font-size: 1.8rem; }
            .btn { padding: 0.7rem 1.5rem; }
            .question-text { font-size: 1.2rem; }
            .wax-seal { width: 60px; height: 60px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>With all the grace my silly heart could gather</h1>
            <div class="wax-seal">üíñ</div>
            <p class="intro-text">If this feels easier for you, My Dearest...</p>
        </header>

        <!-- Name Input Section -->
        <div id="name-section" class="section visible">
            <div class="form-group">
                <label for="name">Your Most Beloved Name:</label>
                <input type="text" id="name" placeholder="Whom do I have the honor of addressing?" required>
            </div>
            <button id="name-submit-btn" class="btn btn-block" style="background-color: var(--royal-blue);">Present Thyself</button>
        </div>

        <!-- Welcome Section -->
        <div id="welcome-section" class="section">
            <div class="personal-greeting" id="personal-greeting">My Dearest Afrah</div>
            <div class="intro-text">
                <p>I penned these words with trembling hand and hopeful heart, that we might bridge what distance lies between us at the moment. Forgive me if you will, for the clinginess in this. I am not sure if my heart will even ever get to do this again. </p>
                <p>Here lies a scroll of questions from my heart to yours. Answer only what you will, in your own time.</p>
            </div>
            <button id="welcome-continue-btn" class="btn btn-block" style="background-color: var(--royal-blue);">Unfurl the Scroll</button>
        </div>

        <!-- Ready Check Section -->
        <div id="ready-section" class="section">
            <div class="ready-check">
                <div class="question-text">Is your heart open to receive these words?</div>
                <p>Pray, only proceed if you feel ready for this tender exchange.</p>
                
                <div class="ready-options">
                    <button class="ready-btn yes" id="ready-yes">With all my heart</button>
                    <button class="ready-btn no" id="ready-no">Not at this hour</button>
                </div>
            </div>
        </div>
<!-- Question 1 -->
<div id="question-1" class="section">
<div class="question-text">So, hows the weathere there?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 2 -->
<div id="question-2" class="section">
<div class="question-text">Did thou try popcorn chicken biryani?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 3 -->
<div id="question-3" class="section">
<div class="question-text">What gentle breeze hath carried thee away from me of late?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 4 -->
<div id="question-4" class="section">
<div class="question-text">Do thoughts of me e'er visit thy quiet moments?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 5 -->
<div id="question-5" class="section">
<div class="question-text">Have I wounded thee unknowingly with any word or deed?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 6 -->
<div id="question-6" class="section">
<div class="question-text">Did I ever make thee feel seen, truly?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 7 -->
<div id="question-7" class="section">
<div class="question-text">Was it a peace or a burden, the way I loved thee?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 8 -->
<div id="question-8" class="section">
<div class="question-text">What truth wouldst thou share, were thy heart utterly safe?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 9 -->
<div id="question-9" class="section">
<div class="question-text">What secret of thy soul wouldst thou have me understand better?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 10 -->
<div id="question-10" class="section">
<div class="question-text">Have my fears of thy new chapter lacking room for me cometh true?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 11 -->
<div id="question-11" class="section">
<div class="question-text">Doth our tale feel concluded to thee, or merely paused by time?</div>
<textarea placeholder="Speak thy heart freely..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

<!-- Question 12 -->
<div id="question-12" class="section">
<div class="question-text">If this be Fi Amanillah, wouldst thou leave me a final line to fold into my silence?</div>
<textarea placeholder="Only if thy soul feels ready..."></textarea>
<div class="button-group">
<button class="btn btn-back">‚Üê Retreat</button>
<button class="btn btn-submit">Continue ‚Üí</button>
</div>
</div>

        <!-- Final Message -->
        <div id="final-section" class="section">
            <div class="final-message">
                <p>You owe me no answers, beloved, yet each word would be more precious than gold.</p>
                <p>My gratitude for your patience in reading these words.</p>
                
                <div class="confirmation-dialog" id="confirmation-dialog">
                    <p>Due to limitations of this humble scribe's art, once sent, these words cannot be recalled or amended.</p>
                    <p>Is your heart certain you would send them?</p>
                    <div class="ready-options" style="margin-top: 1.5rem;">
                        <button class="ready-btn yes" id="confirm-yes">Yea, I am sure</button>
                        <button class="ready-btn no" id="confirm-no">Nay, I would review</button>
                    </div>
                </div>
                
                <button id="submit-all-btn" class="btn btn-block" style="background-color: var(--royal-blue); margin-top: 2rem;" disabled>Seal With a Kiss</button>
            </div>
        </div>

        <footer>
          ü§ç Penned with trembling hand and hopeful heart ü§ç
        </footer>
    </div>
<div id="thank-you-section" class="section">
  <div class="fade-in">
    <h2>üå∏ Thank You, Afrah</h2>
    <p>I appreciate this much more than you will ever think.</p>
  </div>
</div>
<audio id="bg-audio" loop>
    <source src="your-audio.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
</audio>


   <script type="module">
  // Firebase imports
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
  import { firebaseConfig } from './firebase-config.js';

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.addEventListener('DOMContentLoaded', function() {
    // Get all sections dynamically
    const sectionIds = [
      'name-section', 'welcome-section', 'ready-section', 
      ...Array.from(document.querySelectorAll('[id^="question-"]')).map(q => q.id),
      'final-section', 'thank-you-section'
    ];
    
    const sections = sectionIds.map(id => document.getElementById(id));

    // DOM elements
    const nameInput = document.getElementById('name');
    const nameSubmitBtn = document.getElementById('name-submit-btn');
    const personalGreeting = document.getElementById('personal-greeting');
    const welcomeContinueBtn = document.getElementById('welcome-continue-btn');
    const readyYesBtn = document.getElementById('ready-yes');
    const readyNoBtn = document.getElementById('ready-no');
    const submitAllBtn = document.getElementById('submit-all-btn');
    const confirmDialog = document.getElementById('confirmation-dialog');
    const confirmYesBtn = document.getElementById('confirm-yes');
    const confirmNoBtn = document.getElementById('confirm-no');
    const textareas = document.querySelectorAll('textarea');
    const backButtons = document.querySelectorAll('.btn-back');
    const bgAudio = document.getElementById('bg-audio');

    // Track current section
    let currentSectionIndex = 0;
    let userName = '';

    // Initialize
    showCurrentSection();
    setupEventListeners();

    function showCurrentSection() {
      sections.forEach((section, index) => {
        section.classList.toggle('visible', index === currentSectionIndex);
      });
    }

    function setupEventListeners() {
      // Audio setup
      const enableAudioOnce = () => {
        bgAudio.play().catch(console.error);
        document.removeEventListener('click', enableAudioOnce);
        document.removeEventListener('keydown', enableAudioOnce);
      };
      document.addEventListener('click', enableAudioOnce);
      document.addEventListener('keydown', enableAudioOnce);

      // Name submit
      nameSubmitBtn.addEventListener('click', () => {
        if (!nameInput.value.trim()) {
          alert("Pray, grace me with your name to proceed.");
          return;
        }
        userName = nameInput.value.trim();
        personalGreeting.textContent = `My Dearest ${userName}`;
        navigateToNextSection();
      });

      // Navigation buttons
      welcomeContinueBtn.addEventListener('click', navigateToNextSection);
      readyYesBtn.addEventListener('click', navigateToNextSection);
      readyNoBtn.addEventListener('click', () => alert("I shall await a more auspicious hour."));

      // Question continue buttons
      document.querySelectorAll('.btn-submit').forEach(btn => {
        btn.addEventListener('click', () => {
          const textarea = btn.closest('.section').querySelector('textarea');
          if (!textarea.value.trim()) {
            alert("I beseech you, share your thoughts ere we continue.");
            return;
          }
          navigateToNextSection();
        });
      });

      // Back buttons
      backButtons.forEach(btn => btn.addEventListener('click', navigateToPreviousSection));

      // Submit flow
      submitAllBtn.addEventListener('click', () => {
        confirmDialog.classList.add('visible');
        confirmDialog.scrollIntoView({ behavior: 'smooth', block: 'center' });
      });

      confirmYesBtn.addEventListener('click', submitAllAnswers);
      confirmNoBtn.addEventListener('click', () => {
        confirmDialog.classList.remove('visible');
        const firstUnanswered = [...textareas].findIndex(ta => !ta.value.trim());
        navigateToSection(3 + (firstUnanswered === -1 ? textareas.length - 1 : firstUnanswered));
      });

      // Validate answers
      textareas.forEach(ta => {
        ta.addEventListener('input', () => {
          submitAllBtn.disabled = ![...textareas].every(t => t.value.trim());
        });
      });
    }

    function navigateToSection(index) {
      currentSectionIndex = Math.max(0, Math.min(index, sections.length - 1));
      showCurrentSection();
      sections[currentSectionIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function navigateToNextSection() {
      navigateToSection(currentSectionIndex + 1);
    }

    function navigateToPreviousSection() {
      navigateToSection(currentSectionIndex - 1);
    }

    async function submitAllAnswers() {
      confirmDialog.classList.remove('visible');
      submitAllBtn.disabled = true;
      submitAllBtn.textContent = 'Sending...';

      try {
        await addDoc(collection(db, "afrahResponses"), {
          name: userName,
          timestamp: new Date(),
          answers: [...document.querySelectorAll('[id^="question-"]')].map(q => ({
            question: q.querySelector('.question-text').textContent,
            answer: q.querySelector('textarea').value
          }))
        });
        
        navigateToSection(sections.length - 1); // Thank you page
        submitAllBtn.textContent = 'Sent Successfully, Heart to Heart ‚ù§Ô∏è';
      } catch (e) {
        console.error("Submission error:", e);
        alert("Alas! The message could not be sent. Please try again.");
        submitAllBtn.disabled = false;
        submitAllBtn.textContent = 'Seal With Grace';
      }
    }
  });
</script>
</body>
</html>

